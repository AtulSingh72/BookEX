<% include partials/header %>
<!-- Navbar Begins -->

<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
		  <a class="navbar-brand mb-0 h1" href="/">KitabBuddy</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		  </button>

		  <div class="collapse navbar-collapse" id="navbarSupportedContent">
			  <ul class="navbar-nav mr-auto">
				  <li class="nav-item my-auto"><a class="nav-link" href="/" style="margin: 0 10px;">Home</a></li>
				  <li class="nav-item my-auto"><a class="nav-link" href="/books" style="margin: 0 10px;">Books</a></li>
				  <li class="nav-item my-auto"><a class="nav-link" href="/ebooks" style="margin: 0 10px;">E-Books/PDFs</a></li>
				  <li class="nav-item my-auto"><a class="nav-link" href="" style="margin: 0 10px;">Miscellaneous</a></li>
				  <li class="nav-item my-auto"><a class="nav-link" href="/books/new" style="margin: 0 10px;">Lend Items</a></li>
				  <% if(currentUser != null) {%>
				  <li class="nav-item my-auto"><a class="nav-link" href="/mybooks" style="margin: 0 10px;">My Books</a></li>
				  <% } %>
			  </ul>
			<ul class="navbar-nav ml-auto">
				<li class="nav-item">
					<form class="form-inline my-2 my-lg-0" action="/books" method="GET">
						<div class="input-group">
							<div class="input-group-prepend">
								<span class="input-group-text" id="basic-addon1"><i class="fa fa-search"></i></span>
							</div>
							<input type="text" name="search" class="form-control" placeholder="Search Books...">
						</div>
						<button class="btn btn-info my-2 my-sm-0" style="margin: 0 10px;">Search</button>
					</form>
				</li>
				<% if (!currentUser) { %>
				<li class="nav-item">
					<form class="form-inline my-2 my-lg-0" action="/signup" method="GET">
						<button class="btn btn-outline-info my-2 my-sm-0" style="margin: 0 10px;">Sign Up</button>
					</form>
				</li>
				<li class="nav-item">
					<form class="form-inline my-2 my-lg-0" action="/signin" method="GET">
						<button class="btn btn-outline-success my-2 my-sm-0" style="margin: 0 10px;">Sign In</button>
					</form>
				</li>
				<% } else { %>
				<li class="nav-item" style="text-align: center;">
					<span class="my-2 my-lg-0 mx-4">Signed in as:</span>
					<br>
					<span class="my-2 my-lg-0 mx-4"><%= currentUser.firstname %> <%= currentUser.lastname %></span>
				</li>
				<li class="nav-item my-auto" style="text-align: center;color:white;font-size: 24px;">
					<a class="my-2 my-lg-0 mx-4" style="color: black;background-color: transparent;border: 0;" href="<%= currentUser._id.toString() %>/cart"><i class="fa fa-shopping-cart"></i></a>
				</li>
				<li class="nav-item">
					<form class="form-inline my-2 my-lg-0" action="/signout" method="GET">
						<button class="btn btn-outline-danger my-2 my-sm-0" style="margin: 0 10px;">Sign Out</button>
					</form>
				</li>
				<% } %>
			</ul>
			
		  </div>
		</nav>

<!-- End of Navbar -->
<div class="card-deck" style="margin-top: 75px;">
	<% records.forEach(function(row){ %>
	<% if(row.is_display == null || !row.is_display) { %>
	<div class="col-lg-3 col-md-6" style="margin-bottom: 15px;">
  <div class="card">
	  <div class="card-img-top img-fluid" style="width:100%; height:200px; overflow: hidden; display:flex; padding: 7px;">
		<img class="card-img-top img-fluid" src="<%= row.image %>" alt="Card image cap" style="object-fit: contain;">
	  </div>
	<div class="card-body">
		<% if(row.title.length > 25) { %>
	  		<h4 class="card-title" style="text-align: center"><%= row.title.substring(0, 25)%> ....</h4>
		<% } else { %>
			<h4 class="card-title" style="text-align: center"><%= row.title%></h4>
		<% } %>
		<% if(row.description.length > 92) { %>
			<p class="card-text"><%= row.description.substring(0, 92)%> ....</p>
		<% } else { %>
			<p class="card-text"><%= row.description%></p>
		<% } %>
		<form action="/books/<%= row._id %>" method="GET">
			<button type="submit" class="btn btn-sm btn-primary" style="float:left;"><i class="fa fa-info"></i> More</button>
		</form>
		<% if(currentUser !=null) { if(currentUser.username == row.uploader || currentUser.username == 'kitabbuddy1234@gmail.com') { %>
			<form action="/secretkitab04848/<%= row._id %>/accept" method="GET">
				<button type="submit" class="btn btn-sm btn-success" style="float:right"><i class="fa fa-check"></i> Accept</button>
			</form>
			<form action="/books/<%= row._id %>?_method=DELETE" method="POST">
				<button type="submit" class="btn btn-sm btn-danger" style="float:right; margin-right:10px;"><i class="fa fa-times"></i> Discard</button>
			</form>
		<% } %>
		<% } %>
	</div>
	<div class="card-footer">
		<small class="text-muted"><bold>Author: <%= row.author %></bold></small>
		<hr>
		  <small class="text-muted font-weight-bold"><bold>Price: <%= row.price %></bold></small>
	</div>
		</div>
  </div>
	<% } %>
	<% }) %>
</div>

<% include partials/footer %>